<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Surf Spots Counter Test</title>
    <link rel="stylesheet" href="style.css">
    <style>
        body {
            padding: 20px;
            background-color: var(--bg-volcanic-night);
            color: var(--text-salt-crystal);
        }
        
        .test-container {
            max-width: 800px;
            margin: 0 auto;
        }
        
        .test-section {
            margin-bottom: 30px;
            padding: 20px;
            background-color: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
        }
        
        .test-button {
            background-color: var(--accent-lava-glow);
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 4px;
            margin: 5px;
            cursor: pointer;
        }
        
        .test-button:hover {
            background-color: var(--accent-lava-glow-dark);
        }
        
        .test-results {
            margin-top: 15px;
            padding: 10px;
            background-color: rgba(0, 0, 0, 0.3);
            border-radius: 4px;
            font-family: monospace;
        }
        
        .counter-demo {
            position: relative;
            width: 280px;
            margin: 20px 0;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>Surf Spots Counter Test</h1>
        
        <div class="test-section">
            <h2>Counter Display Test</h2>
            <p>Testing the counter display with different values:</p>
            
            <div class="counter-demo">
                <!-- Left Side Search Control -->
                <div class="left-side-search-container" id="left-side-search" style="position: relative; transform: none; opacity: 1;">
                    <div class="surf-map-search">
                        <input type="text" class="surf-map-search-input" placeholder="Search surf spots..." aria-label="Search surf spots">
                        <button class="surf-map-search-btn" aria-label="Search">
                            <svg width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                                <path d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0z"/>
                            </svg>
                        </button>
                        <button class="surf-map-clear-btn" aria-label="Clear search">
                            <svg width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                                <path d="M2.146 2.854a.5.5 0 1 1 .708-.708L8 7.293l5.146-5.147a.5.5 0 0 1 .708.708L8.707 8l5.147 5.146a.5.5 0 0 1-.708.708L8 8.707l-5.146 5.147a.5.5 0 0 1-.708-.708L7.293 8 2.146 2.854Z"/>
                            </svg>
                        </button>
                    </div>
                    <!-- Surf Spots Counter -->
                    <div class="surf-spots-counter" id="surf-spots-counter" role="status" aria-live="polite" aria-label="Number of visible surf spots">
                        <span class="counter-number" id="counter-number">0</span>
                        <span class="counter-label" id="counter-label">surf spots</span>
                    </div>
                </div>
            </div>
            
            <div>
                <button class="test-button" onclick="updateCounter(0)">Set to 0</button>
                <button class="test-button" onclick="updateCounter(1)">Set to 1</button>
                <button class="test-button" onclick="updateCounter(5)">Set to 5</button>
                <button class="test-button" onclick="updateCounter(10)">Set to 10</button>
                <button class="test-button" onclick="updateCounter(100)">Set to 100</button>
                <button class="test-button" onclick="updateCounter(1000)">Set to 1,000</button>
                <button class="test-button" onclick="updateCounter(10000)">Set to 10,000</button>
            </div>
            
            <div class="test-results" id="test-results">
                Click buttons above to test counter updates
            </div>
        </div>
        
        <div class="test-section">
            <h2>Animation Test</h2>
            <p>Testing the counter animation with rapid changes:</p>
            
            <div>
                <button class="test-button" onclick="animateCounter()">Animate Counter</button>
                <button class="test-button" onclick="stopAnimation()">Stop Animation</button>
            </div>
            
            <div class="test-results" id="animation-results">
                Click "Animate Counter" to start the animation test
            </div>
        </div>
        
        <div class="test-section">
            <h2>Accessibility Test</h2>
            <p>Testing screen reader announcements:</p>
            
            <div>
                <button class="test-button" onclick="testAccessibility()">Test Accessibility</button>
            </div>
            
            <div class="test-results" id="accessibility-results">
                Check the aria-label attribute of the counter element
            </div>
        </div>
    </div>

    <script type="module">
        import { SurfSpotsCounter } from './scripts/surf-map/surf-counter.js';
        
        let counter;
        let animationInterval;
        
        // Initialize counter when DOM is loaded
        document.addEventListener('DOMContentLoaded', () => {
            const counterElement = document.getElementById('surf-spots-counter');
            if (counterElement) {
                counter = new SurfSpotsCounter(counterElement, {
                    singularLabel: 'surf spot',
                    pluralLabel: 'surf spots',
                    animationDuration: 300
                });
                
                // Initialize with a value
                counter.updateCount(25);
                
                document.getElementById('test-results').textContent = 
                    `Counter initialized with value: ${counter.getCurrentCount()}`;
            }
        });
        
        // Global functions for button clicks
        window.updateCounter = function(value) {
            if (counter) {
                const previousCount = counter.getCurrentCount();
                counter.updateCount(value);
                
                document.getElementById('test-results').textContent = 
                    `Counter updated from ${previousCount} to ${value}`;
            }
        };
        
        window.animateCounter = function() {
            if (counter) {
                let count = 0;
                let direction = 1;
                
                animationInterval = setInterval(() => {
                    count += direction;
                    
                    if (count >= 20 || count <= 0) {
                        direction *= -1;
                    }
                    
                    counter.updateCount(count);
                    
                    document.getElementById('animation-results').textContent = 
                        `Animation running: Current count = ${count}`;
                }, 500);
            }
        };
        
        window.stopAnimation = function() {
            if (animationInterval) {
                clearInterval(animationInterval);
                animationInterval = null;
                
                document.getElementById('animation-results').textContent = 
                    'Animation stopped';
            }
        };
        
        window.testAccessibility = function() {
            if (counter) {
                const counterElement = document.getElementById('surf-spots-counter');
                const ariaLabel = counterElement.getAttribute('aria-label');
                
                document.getElementById('accessibility-results').textContent = 
                    `Current aria-label: "${ariaLabel}"`;
                
                // Test with a new value to see if the aria-label updates
                counter.updateCount(42);
                
                setTimeout(() => {
                    const newAriaLabel = counterElement.getAttribute('aria-label');
                    document.getElementById('accessibility-results').textContent = 
                        `Previous aria-label: "${ariaLabel}"\nNew aria-label: "${newAriaLabel}"`;
                }, 500);
            }
        };
    </script>
</body>
</html>